package malware_gotchi;
import java.util.Scanner;

public abstract class AbstractGame {

	protected FileHandler file;
	protected String name;
	protected int batteriesEarned;
	protected int batteriesLost;
	protected double happinessEarned;
	protected double happinessLost;
	protected String instructions;
	
	public Boolean menu(Scanner sc, Pet myPet) {
		Boolean exitToMain = false;
		Boolean exit = false;
		String[] options = {"1", "2", "3"};
    	String ansStr;
    	Boolean go;
    	do {
    		int ans; 
			System.out.println("Welcome to "+ this.getGameName() +"! What would you like to do?\n"
					+"1. View Instructions\n"
					+"2. Play Game\n"
					+"3. Return to Games Menu\n");
			myPet.waiting();
			ansStr = sc.nextLine();
	        go = false;
	        
	        while(!go) {
	        	for(String i:options) {
	        		if(ansStr.equals(i)){
	        			go = true;
	        		}
	        	}
	        	
	        	if(!go) {
	        		System.out.println("Invalid input. Please try again. ");
	        		ansStr = sc.nextLine();
	        	}
	        }
	        
	        ans = Integer.valueOf(ansStr);
	    	switch(ans) {
	    		case 1:
	    			System.out.println(this.instructions);
	        		System.out.println("\nPress 1 to exit instructions.");
	        		myPet.waiting();

	        		String input;
	        		input = sc.nextLine();
	                while(!input.equals("1")) {
	                		System.out.println("Invalid input. Please try again. ");
	                		input = sc.nextLine();
	                	}
		    		break;
	    		
	    		case 2:
	    			this.play(sc, myPet);
	    			exitToMain = this.replay(sc, myPet);
	    			exit = true;
	    			
	    		case 3:
	    			exit = true;
	    			break;
	    	}
    	}while (!exit);
	return exitToMain;
	}
    	
	public int getBatteriesEarned() {
		return batteriesEarned;
	}
	
	public int getBatteriesLost() {
		return batteriesLost;
	}
	
	public String getGameName() {
		return name;
	}
	
	protected void won(Pet myPet) {
		myPet.batteries += this.batteriesEarned;
		file.setBatteries(myPet.batteries);
		myPet.updateHappy(this.happinessEarned);
		file.setHappinessChange(myPet.getHappinessChange());
		myPet.waiting();
		
		System.out.println("You won the game! Your pet train earned "+ this.batteriesEarned+" "
				+ "batteries and "+ this.happinessEarned+" happiness.\n");
		myPet.waiting();
	}
	
	protected void lost(Pet myPet) {
		myPet.updateHappy(this.happinessLost);
		file.setHappinessChange(myPet.getHappinessChange());
		myPet.batteries -= this.batteriesLost;
		file.setBatteries(myPet.batteries);
		if(this.batteriesLost == 0) {
			System.out.println("You lost the game! Your pet train didnâ€™t earn any batteries and lost "+ this.happinessLost+" happiness.\n");
		}
		else {
			System.out.println("You lost the game! Your pet train lost "+this.batteriesLost+" batteries and "+ this.happinessLost+" happiness.\n");
		}
		myPet.waiting();
	};
	
	private Boolean replay(Scanner sc, Pet myPet) {  //replay menu
		Boolean exit = false;
		Boolean exitToMain = false;
		String[] options = {"1", "2", "3"};
    	String ansStr;
    	Boolean go;
    	int ans; 
    	
			do{
				System.out.println("End of game! What would you like to do?\n"
						+"1. Play Again\n"
						+"2. Return to Games Menu\n"
						+"3. Return to Main Menu\n");
				myPet.waiting();
				ansStr = sc.nextLine();
		        go = false;
		        
		        while(!go) {
		        	for(String i:options) {
		        		if(ansStr.equals(i)){
		        			go = true;
		        		}
		        	}
		        	if(!go) {
		        		System.out.println("Invalid input. Please try again. ");
		        		ansStr = sc.nextLine();
		        	}
		        }
		        
		        ans = Integer.valueOf(ansStr);
		    	switch(ans) {
		    		case 1:
		    			this.play(sc, myPet);
			    		break;
		    		
		    		case 2:
		    			exit = true;
		    			break;
		    			
		    		case 3:
		    			exit = true;
		    			exitToMain = true;
		    			break;
		    		
		    	}
	    	}while(!exit);
		return exitToMain;
	}
	
	protected abstract void play(Scanner sc, Pet myPet);
}